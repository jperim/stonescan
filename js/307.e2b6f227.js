"use strict";(self["webpackChunkstonescan"]=self["webpackChunkstonescan"]||[]).push([[307],{9307:(a,e,i)=>{i.r(e),i.d(e,{default:()=>I});var t=i(3673),o=i(2323);const n=(0,t.Wm)("div",{class:"text-h6"},"Atualizar Tabelas de Cadastros",-1),r=(0,t.Wm)("div",{class:"text-subtitle2"},"Sincronismo com servidor (onLine)",-1),d={key:1},l=(0,t.Uk)("Iniciar");function s(a,e,i,s,c,u){const m=(0,t.up)("q-card-section"),f=(0,t.up)("q-separator"),g=(0,t.up)("q-spinner"),p=(0,t.up)("q-icon"),w=(0,t.up)("q-item-section"),k=(0,t.up)("q-item-label"),b=(0,t.up)("q-badge"),z=(0,t.up)("q-item"),h=(0,t.up)("q-list"),_=(0,t.up)("q-btn"),q=(0,t.up)("q-card-actions"),v=(0,t.up)("q-card"),y=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(y,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[n,r])),_:1}),(0,t.Wm)(f),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(h,{bordered:"",padding:"",class:"rounded-borders"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.j4)(t.HY,null,(0,t.Ko)(s.tabelas,(a=>((0,t.wg)(),(0,t.j4)(z,{key:a.id},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{avatar:"",top:""},{default:(0,t.w5)((()=>[a.iniciado?((0,t.wg)(),(0,t.j4)(g,{key:0,color:"primary",size:"3em"})):((0,t.wg)(),(0,t.j4)("div",d,[a.finalizado?((0,t.wg)(),(0,t.j4)(p,{key:0,name:"check_circle_outline",color:"positive",size:"lg"})):((0,t.wg)(),(0,t.j4)(p,{key:1,name:"check_circle_outline",size:"lg"}))]))])),_:2},1024),(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,{lines:"1"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(a.name),1)])),_:2},1024),a.erro?((0,t.wg)(),(0,t.j4)(k,{key:0},{default:(0,t.w5)((()=>[(0,t.Uk)("Ocorreu erro: "+(0,o.zw)(a.erromsg),1)])),_:2},1024)):(0,t.kq)("",!0)])),_:2},1024),a.finalizado&&a.data.length>0?((0,t.wg)(),(0,t.j4)(w,{key:0,side:"",top:""},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{color:"teal",label:a.data.length},null,8,["label"])])),_:2},1024)):(0,t.kq)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,t.Wm)(q,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{color:"primary",onClick:e[1]||(e[1]=a=>s.IniciarAtualizacao())},{default:(0,t.w5)((()=>[l])),_:1})])),_:1})])),_:1})])),_:1})}var c=i(8825),u=i(1959),m=i(7874),f=i(5474);const g={name:"AtualizaTabelasServidor",setup(){const a=(0,c.Z)(),e=(0,m.oR)(),i=(0,u.iH)([{id:1,name:"Fornecedores",iniciado:!1,finalizado:!1,data:[],erro:!1,erromsg:""},{id:2,name:"Condições de Pagamento",iniciado:!1,finalizado:!1,data:[],erro:!1,erromsg:""},{id:3,name:"Moedas",iniciado:!1,finalizado:!1,data:[],erro:!1,erromsg:""},{id:4,name:"Produtos",iniciado:!1,finalizado:!1,data:[],erro:!1,erromsg:""},{id:5,name:"Classificações",iniciado:!1,finalizado:!1,data:[],erro:!1,erromsg:""}]);async function t(e){let i=3e3,t=0;while(i>0)await f.api.get("/v1/tabelas/fornecedores",{params:{limit:i,offset:t}}).then((a=>{e.data=e.data.concat(a.data),t+=i+1,a.data.length<i&&(i=0)})).catch((t=>{i=0,e.erro=!0,e.erromsg=t,a.notify({type:"negative",message:t.message}),console.error(t)}));e.erro||await o(e.data)}async function o(a){let i=a.map((a=>({id:a.codcad,nome:a.nome,fantasia:"",endereco:"",cidade:"",uf:""})));await e.dispatch("fornecedor/saveAll",i)}async function n(){for(let a=0;a<i.value.length;a++){const o=i.value[a];switch(o.finalizado=!1,o.erro=!1,o.data=[],o.id){case 1:o.iniciado=!0,await t(o).then((()=>{o.iniciado=!1,o.finalizado=!0,o.registros=e.getters["fornecedor/fornecedores"].length}));break;case 2:break;case 3:break;case 4:break;case 5:break}}}return{tabelas:i,IniciarAtualizacao:n}}};var p=i(4379),w=i(151),k=i(5589),b=i(5869),z=i(7011),h=i(3414),_=i(2035),q=i(9754),v=i(4554),y=i(2350),Z=i(9721),Q=i(9367),W=i(2165),j=i(7518),C=i.n(j);g.render=s;const I=g;C()(g,"components",{QPage:p.Z,QCard:w.Z,QCardSection:k.Z,QSeparator:b.Z,QList:z.Z,QItem:h.Z,QItemSection:_.Z,QSpinner:q.Z,QIcon:v.Z,QItemLabel:y.Z,QBadge:Z.Z,QCardActions:Q.Z,QBtn:W.Z})}}]);